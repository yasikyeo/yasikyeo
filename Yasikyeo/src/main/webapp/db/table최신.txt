/* 회원 */
DROP TABLE MEMBER 
	CASCADE CONSTRAINTS;

/* 주소 */
DROP TABLE ADDRESS 
	CASCADE CONSTRAINTS;

/* 상품카테고리 */
DROP TABLE CATEGORI 
	CASCADE CONSTRAINTS;

/* 상품 */
DROP TABLE PRODUCT 
	CASCADE CONSTRAINTS;

/* 업소 */
DROP TABLE SHOP 
	CASCADE CONSTRAINTS;

/* 주문내역 */
DROP TABLE ORDERLIST 
	CASCADE CONSTRAINTS;

/* 관리자 */
DROP TABLE MANAGER 
	CASCADE CONSTRAINTS;

/* 사장님 */
DROP TABLE CEO 
	CASCADE CONSTRAINTS;

/* FAQ */
DROP TABLE FAQ 
	CASCADE CONSTRAINTS;

/* 공지사항/이벤트 */
DROP TABLE NOTICE 
	CASCADE CONSTRAINTS;

/* QnA */
DROP TABLE QnA 
	CASCADE CONSTRAINTS;

/* 댓글 */
DROP TABLE REPLY 
	CASCADE CONSTRAINTS;

/* 구매후기 */
DROP TABLE REVIEW 
	CASCADE CONSTRAINTS;

/* 즐겨찾기 */
DROP TABLE BOOKMARK 
	CASCADE CONSTRAINTS;

/* 회원 */
CREATE TABLE MEMBER (
	MEMBER_NO NUMBER NOT NULL, /* 회원코드 */
	MEMBER_ID VARCHAR2(30) NOT NULL, /* 회원아이디 */
	MEMBER_PWD VARCHAR2(30) NOT NULL, /* 회원비밀번호 */
	MEMBER_NAME VARCHAR2(30) NOT NULL, /* 새 컬럼 */
	MEMBER_NICKNAME VARCHAR2(50) NOT NULL, /* 회원닉네임 */
	MEMBER_TEL VARCHAR2(30) NOT NULL, /* 회원전화번호 */
	MEMBER_EMAIL VARCHAR2(40) NOT NULL, /* 회원이메일 */
	MEMBER_BIRTH NUMBER(8) NOT NULL, /* 회원생년월일 */
	MEMBER_POINT NUMBER, /* 회원포인트 */
	MEMBER_REGDATE DATE DEFAULT SYSDATE, /* 회원가입일 */
	MEMBER_WITHDRAW CHAR DEFAULT 'N', /* 탈퇴여부 */
	ADDRESS VARCHAR2(100) NOT NULL, /* 주소 */
	ADDRESSDETAIL VARCHAR2(100) NOT NULL, /* 상세주소 */
	POSTCODE VARCHAR(20) NOT NULL, /* 우편번호 */
	AUTHCODE VARCHAR2(15) DEFAULT 'USER' /* 권한코드 */
);

CREATE UNIQUE INDEX PK_MEMBER
	ON MEMBER (
		MEMBER_NO ASC
	);

ALTER TABLE MEMBER
	ADD
		CONSTRAINT PK_MEMBER
		PRIMARY KEY (
			MEMBER_NO
		);

/* 주소 */
CREATE TABLE ADDRESS (
	ADDRESS_NO NUMBER NOT NULL, /* 주소코드 */
	ADDRESS_SI VARCHAR2(100), /* 시·도 */
	ADDRESS_DO VARCHAR2(100), /* 구·군 */
	ADDRESS_DONG VARCHAR2(100), /* 동 */
	ADDRESS_DETAIL VARCHAR2(500), /* 상세주소 */
	ADDRESS_ZIPCODE VARCHAR2(50) /* 우편번호 */
);

CREATE UNIQUE INDEX PK_ADDRESS
	ON ADDRESS (
		ADDRESS_NO ASC
	);

ALTER TABLE ADDRESS
	ADD
		CONSTRAINT PK_ADDRESS
		PRIMARY KEY (
			ADDRESS_NO
		);

/* 상품카테고리 */
CREATE TABLE CATEGORI (
	CATEGORI_NO NUMBER NOT NULL, /* 상품카테고리코드 */
	CATEGORI_NAME VARCHAR2(500) NOT NULL, /* 상품카테고리명 */
	SHOP_NO NUMBER /* 업소코드 */
);

CREATE UNIQUE INDEX PK_CATEGORI
	ON CATEGORI (
		CATEGORI_NO ASC
	);

ALTER TABLE CATEGORI
	ADD
		CONSTRAINT PK_CATEGORI
		PRIMARY KEY (
			CATEGORI_NO
		);

/* 상품 */
CREATE TABLE PRODUCT (
	PRODUCT_NO NUMBER NOT NULL, /* 상품코드 */
	PRODUCT_NAME VARCHAR2(100) NOT NULL, /* 상품명 */
	PRODUCT_EXPLAIN VARCHAR2(500), /* 상품설명 */
	PRODUCT_PRICE VARCHAR2(500) NOT NULL, /* 가격 */
	PRODUCT_OPTION VARCHAR2(500), /* 옵션 */
	PRODUCT_IMG VARCHAR2(100), /* 상품이미지명 */
	PRODUCT_REGDATE DATE DEFAULT SYSDATE, /* 상품등록일 */
	CATEGORI_NO NUMBER /* 상품카테고리코드 */
);

CREATE UNIQUE INDEX PK_PRODUCT
	ON PRODUCT (
		PRODUCT_NO ASC
	);

ALTER TABLE PRODUCT
	ADD
		CONSTRAINT PK_PRODUCT
		PRIMARY KEY (
			PRODUCT_NO
		);

/* 업소 */
CREATE TABLE SHOP (
	SHOP_NO NUMBER NOT NULL, /* 업소코드 */
	SHOP_CATEGORI VARCHAR2(500) DEFAULT '기타', /* 업소카테고리 */
	SHOP_NAME VARCHAR2(100) NOT NULL, /* 업소명 */
	SHOP_IMAGE VARCHAR2(500) NOT NULL, /* 업소이미지 */
	SHOP_EXPLAIN BLOB, /* 업소소개 */
	SHOP_MINPRICE NUMBER NOT NULL, /* 최소금액 */
	SHOP_OPENTIME DATE DEFAULT SYSDATE NOT NULL, /* 오픈시간 */
	SHOP_CLOSETIME DATE DEFAULT SYSDATE NOT NULL, /* 마감시간 */
	SHOP_TEL VARCHAR2(30) NOT NULL, /* 전화번호 */
	SHOP_DELIVERY CHAR NOT NULL, /* 배달여부 */
	SHOP_ORIGIN BLOB, /* 원산지내용 */
	SHOP_POSITION VARCHAR2(500), /* 지도좌표 */
	SHOP_ACCOUNT VARCHAR2(500), /* 업소은행계좌 */
	SHOP_LICENSEE VARCHAR2(12) NOT NULL, /* 사업자등록번호 */
	SHOP_HIT NUMBER, /* 즐겨찾기횟수 */
	SHOP_AVGREVIEW NUMBER(2,1), /* 리뷰별점평균 */
	SHOP_REVIEWCNT NUMBER, /* 리뷰갯수 */
	SHOP_CEOREPLYCNT NUMBER, /* 사장님댓글갯수 */
	CEO_NO NUMBER /* 사장님코드 */
);

CREATE UNIQUE INDEX PK_SHOP
	ON SHOP (
		SHOP_NO ASC
	);

ALTER TABLE SHOP
	ADD
		CONSTRAINT PK_SHOP
		PRIMARY KEY (
			SHOP_NO
		);

/* 주문내역 */
CREATE TABLE ORDERLIST (
	ORDERLIST_NO NUMBER NOT NULL, /* 주문코드 */
	ORDERLIST_REGDATE DATE DEFAULT SYSDATE, /* 주문일시 */
	ORDERLIST_QTY NUMBER NOT NULL, /* 주문수량 */
	ORDERLIST_PRICE VARCHAR2(500) NOT NULL, /* 주문가격 */
	ORDERLIST_OPTPRICE VARCHAR2(500), /* 옵션가격 */
	ORDERLIST_CARGEPRICE NUMBER, /* 결제금액 */
	ORDERLIST_CARGEWAY VARCHAR2(500), /* 결제방법 */
	ORDERLIST_COMPLEDAY DATE DEFAULT SYSDATE, /* 결제완료일 */
	ORDERLIST_STATE VARCHAR2(100) DEFAULT '접수대기', /* 주문상태 */
	PRODUCT_NO NUMBER, /* 상품코드 */
	MEMBER_NO NUMBER /* 회원코드 */
);

CREATE UNIQUE INDEX PK_ORDERLIST
	ON ORDERLIST (
		ORDERLIST_NO ASC
	);

ALTER TABLE ORDERLIST
	ADD
		CONSTRAINT PK_ORDERLIST
		PRIMARY KEY (
			ORDERLIST_NO
		);

/* 관리자 */
CREATE TABLE MANAGER (
	MANAGER_NO NUMBER NOT NULL, /* 관리자코드 */
	MANAGER_ID VARCHAR2(30) NOT NULL, /* 관리자아이디 */
	MANAGER_PWD VARCHAR2(30) NOT NULL, /* 관리자비밀번호 */
	MANAGER_NAME VARCHAR2(100) NOT NULL, /* 관리자이름 */
	MANAGER_REGDATE DATE DEFAULT SYSDATE, /* 관리자가입일 */
	AUTHCODE VARCHAR2(15) DEFAULT 'ADMIN' /* 권한코드 */
);

CREATE UNIQUE INDEX PK_MANAGER
	ON MANAGER (
		MANAGER_NO ASC
	);

ALTER TABLE MANAGER
	ADD
		CONSTRAINT PK_MANAGER
		PRIMARY KEY (
			MANAGER_NO
		);

/* 사장님 */
CREATE TABLE CEO (
	CEO_NO NUMBER NOT NULL, /* 사장님코드 */
	CEO_ID VARCHAR2(100) NOT NULL, /* 사장님아이디 */
	CEO_PWD VARCHAR2(30) NOT NULL, /* 사장님비밀번호 */
	CEO_NAME VARCHAR2(100) NOT NULL, /* 사장님이름 */
	CEO_EMAIL VARCHAR2(40) NOT NULL, /* 사장님이메일 */
	CEO_TEL VARCHAR2(30) NOT NULL, /* 사장님전화번호 */
	CEO_REGDATE DATE DEFAULT SYSDATE, /* 사장님가입일 */
	CEO_WITHDRAW CHAR DEFAULT 'N', /* 탈퇴여부 */
	AUTHCODE VARCHAR2(15) DEFAULT 'CEO' /* 권한코드 */
);

CREATE UNIQUE INDEX PK_CEO
	ON CEO (
		CEO_NO ASC
	);

ALTER TABLE CEO
	ADD
		CONSTRAINT PK_CEO
		PRIMARY KEY (
			CEO_NO
		);

/* FAQ */
CREATE TABLE FAQ (
	FAQ_NO NUMBER NOT NULL, /* FAQ글번호 */
	FAQ_TITLE VARCHAR2(100) NOT NULL, /* 질문제목 */
	FAQ_CONTENT BLOB NOT NULL, /* 답변내용 */
	FAQ_UPFILENAME VARCHAR2(100), /* 업로드파일명 */
	FAQ_CATEGORI VARCHAR2(100) NOT NULL, /* 질문카테고리 */
	MANAGER_NO NUMBER /* 관리자코드 */
);

CREATE UNIQUE INDEX PK_FAQ
	ON FAQ (
		FAQ_NO ASC
	);

ALTER TABLE FAQ
	ADD
		CONSTRAINT PK_FAQ
		PRIMARY KEY (
			FAQ_NO
		);

/* 공지사항/이벤트 */
CREATE TABLE NOTICE (
	NOTICE_NO NUMBER NOT NULL, /* 공지번호 */
	NOTICE_TITLE VARCHAR2(100) NOT NULL, /* 공지제목 */
	NOTICE_CONTENT BLOB NOT NULL, /* 공지내용 */
	NOTICE_UPFILENAME VARCHAR2(100), /* 공지업로드파일명 */
	NOTICE_SUFFIX VARCHAR2(100) NOT NULL, /* 공지머릿말 */
	MANAGER_NO NUMBER /* 관리자코드 */
);

CREATE UNIQUE INDEX PK_NOTICE
	ON NOTICE (
		NOTICE_NO ASC
	);

ALTER TABLE NOTICE
	ADD
		CONSTRAINT PK_NOTICE
		PRIMARY KEY (
			NOTICE_NO
		);

/* QnA */
CREATE TABLE QnA (
	QnA_NO NUMBER NOT NULL, /* QnA글번호 */
	QnA_NAME VARCHAR2(100), /* QnA이름 */
	QnA_EMAIL VARCHAR2(40) NOT NULL, /* QnA이메일 */
	QnA_CATEGORI VARCHAR2(100) NOT NULL, /* QnA카테고리 */
	QnA_TITLE VARCHAR2(500) NOT NULL, /* QnA제목 */
	QnA_CONTENT BLOB NOT NULL, /* QnA문의내용 */
	QnA_UPFILENAME VARCHAR2(50), /* QnA업로드파일명 */
	QnA_ORIGINFILENAME VARCHAR2(50), /* QnA오리지날파일명 */
	QnA_UPFILENAME2 VARCHAR2(50), /* QnA업로드파일명2 */
	QnA_ORIGINFILENAME2 VARCHAR2(50), /* QnA오리지날파일명2 */
	QnA_UPFILENAME3 VARCHAR2(50), /* QnA업로드파일명3 */
	QnA_ORIGINFILENAME3 VARCHAR2(50), /* QnA오리지날파일명3 */
	QnA_REGDATE DATE DEFAULT SYSDATE, /* QnA등록일 */
	MEMBER_NO NUMBER, /* 회원코드 */
	CEO_NO NUMBER /* 사장님코드 */
);

CREATE UNIQUE INDEX PK_QnA
	ON QnA (
		QnA_NO ASC
	);

ALTER TABLE QnA
	ADD
		CONSTRAINT PK_QnA
		PRIMARY KEY (
			QnA_NO
		);

/* 댓글 */
CREATE TABLE REPLY (
	REPLY_NO NUMBER NOT NULL, /* 댓글번호 */
	REPLY_NAME VARCHAR2(100) NOT NULL, /* 댓글작성자 */
	REPLY_CONTENT BLOB NOT NULL, /* 댓글내용 */
	REPLY_REGDATE DATE DEFAULT SYSDATE, /* 댓글작성일 */
	MANAGER_NO NUMBER, /* 관리자코드 */
	MEMBER_NO NUMBER, /* 회원코드 */
	QnA_NO NUMBER, /* QnA글번호 */
	REVIEW_NO NUMBER, /* 구매후기글번호 */
	CEO_NO NUMBER /* 사장님코드 */
);

CREATE UNIQUE INDEX PK_REPLY
	ON REPLY (
		REPLY_NO ASC
	);

ALTER TABLE REPLY
	ADD
		CONSTRAINT PK_REPLY
		PRIMARY KEY (
			REPLY_NO
		);

/* 구매후기 */
CREATE TABLE REVIEW (
	REVIEW_HIT NUMBER, /* 구매후기추천수 */
	CEO_NO NUMBER, /* 사장님코드 */
	SHOP_NO NUMBER, /* 업소코드 */
	REVIEW_STARSCORE NUMBER(2,1), /* 구매후기별점 */
	REVIEW_NICKNAME VARCHAR2(100) DEFAULT '손님', /* 구매후기닉네임 */
	REVIEW_CONTENT BLOB NOT NULL, /* 구매후기내용 */
	REVIEW_REGDATE DATE DEFAULT SYSDATE, /* 구매후기작성일 */
	REVIEW_NO NUMBER NOT NULL, /* 구매후기글번호 */
	MEMBER_NO NUMBER /* 회원코드 */
);

CREATE UNIQUE INDEX PK_REVIEW
	ON REVIEW (
		REVIEW_NO ASC
	);

ALTER TABLE REVIEW
	ADD
		CONSTRAINT PK_REVIEW
		PRIMARY KEY (
			REVIEW_NO
		);

/* 즐겨찾기 */
CREATE TABLE BOOKMARK (
	BOOKMARK_NO NUMBER NOT NULL, /* 즐겨찾기코드 */
	SHOP_NO NUMBER, /* 업소코드 */
	MEMBER_NO NUMBER /* 회원코드 */
);

CREATE UNIQUE INDEX PK_BOOKMARK
	ON BOOKMARK (
		BOOKMARK_NO ASC
	);

ALTER TABLE BOOKMARK
	ADD
		CONSTRAINT PK_BOOKMARK
		PRIMARY KEY (
			BOOKMARK_NO
		);

ALTER TABLE CATEGORI
	ADD
		CONSTRAINT FK_SHOP_TO_CATEGORI
		FOREIGN KEY (
			SHOP_NO
		)
		REFERENCES SHOP (
			SHOP_NO
		);

ALTER TABLE PRODUCT
	ADD
		CONSTRAINT FK_CATEGORI_TO_PRODUCT
		FOREIGN KEY (
			CATEGORI_NO
		)
		REFERENCES CATEGORI (
			CATEGORI_NO
		);

ALTER TABLE SHOP
	ADD
		CONSTRAINT FK_CEO_TO_SHOP
		FOREIGN KEY (
			CEO_NO
		)
		REFERENCES CEO (
			CEO_NO
		);

ALTER TABLE ORDERLIST
	ADD
		CONSTRAINT FK_PRODUCT_TO_ORDERLIST
		FOREIGN KEY (
			PRODUCT_NO
		)
		REFERENCES PRODUCT (
			PRODUCT_NO
		);

ALTER TABLE ORDERLIST
	ADD
		CONSTRAINT FK_MEMBER_TO_ORDERLIST
		FOREIGN KEY (
			MEMBER_NO
		)
		REFERENCES MEMBER (
			MEMBER_NO
		);

ALTER TABLE FAQ
	ADD
		CONSTRAINT FK_MANAGER_TO_FAQ
		FOREIGN KEY (
			MANAGER_NO
		)
		REFERENCES MANAGER (
			MANAGER_NO
		);

ALTER TABLE NOTICE
	ADD
		CONSTRAINT FK_MANAGER_TO_NOTICE
		FOREIGN KEY (
			MANAGER_NO
		)
		REFERENCES MANAGER (
			MANAGER_NO
		);

ALTER TABLE QnA
	ADD
		CONSTRAINT FK_MEMBER_TO_QnA
		FOREIGN KEY (
			MEMBER_NO
		)
		REFERENCES MEMBER (
			MEMBER_NO
		);

ALTER TABLE QnA
	ADD
		CONSTRAINT FK_CEO_TO_QnA
		FOREIGN KEY (
			CEO_NO
		)
		REFERENCES CEO (
			CEO_NO
		);

ALTER TABLE REPLY
	ADD
		CONSTRAINT FK_MANAGER_TO_REPLY
		FOREIGN KEY (
			MANAGER_NO
		)
		REFERENCES MANAGER (
			MANAGER_NO
		);

ALTER TABLE REPLY
	ADD
		CONSTRAINT FK_MEMBER_TO_REPLY
		FOREIGN KEY (
			MEMBER_NO
		)
		REFERENCES MEMBER (
			MEMBER_NO
		);

ALTER TABLE REPLY
	ADD
		CONSTRAINT FK_QnA_TO_REPLY
		FOREIGN KEY (
			QnA_NO
		)
		REFERENCES QnA (
			QnA_NO
		);

ALTER TABLE REPLY
	ADD
		CONSTRAINT FK_REVIEW_TO_REPLY
		FOREIGN KEY (
			REVIEW_NO
		)
		REFERENCES REVIEW (
			REVIEW_NO
		);

ALTER TABLE REPLY
	ADD
		CONSTRAINT FK_CEO_TO_REPLY
		FOREIGN KEY (
			CEO_NO
		)
		REFERENCES CEO (
			CEO_NO
		);

ALTER TABLE REVIEW
	ADD
		CONSTRAINT FK_MEMBER_TO_REVIEW
		FOREIGN KEY (
			MEMBER_NO
		)
		REFERENCES MEMBER (
			MEMBER_NO
		);

ALTER TABLE REVIEW
	ADD
		CONSTRAINT FK_SHOP_TO_REVIEW
		FOREIGN KEY (
			SHOP_NO
		)
		REFERENCES SHOP (
			SHOP_NO
		);

ALTER TABLE REVIEW
	ADD
		CONSTRAINT FK_CEO_TO_REVIEW
		FOREIGN KEY (
			CEO_NO
		)
		REFERENCES CEO (
			CEO_NO
		);

ALTER TABLE BOOKMARK
	ADD
		CONSTRAINT FK_SHOP_TO_BOOKMARK
		FOREIGN KEY (
			SHOP_NO
		)
		REFERENCES SHOP (
			SHOP_NO
		);

ALTER TABLE BOOKMARK
	ADD
		CONSTRAINT FK_MEMBER_TO_BOOKMARK
		FOREIGN KEY (
			MEMBER_NO
		)
		REFERENCES MEMBER (
			MEMBER_NO
		);

drop sequence shop_no_seq;
create sequence shop_no_seq
minvalue 1
maxvalue 9999999
increment by 1
start with 1
nocache;

drop sequence ceo_no_seq;
create sequence ceo_no_seq
minvalue 1
maxvalue 9999999
increment by 1
start with 1
nocache;

drop sequence member_no_seq;
create sequence member_no_seq
minvalue 1
maxvalue 9999999
increment by 1
start with 1
nocache;

drop sequence notice_no_seq;
create sequence notice_no_seq
minvalue 1
maxvalue 9999999
increment by 1
start with 1
nocache;

drop sequence admin_no_seq;
create sequence admin_no_seq
minvalue 1
maxvalue 9999999
increment by 1
start with 1
nocache;

drop sequence review_no_seq;
create sequence review_no_seq
minvalue 1
maxvalue 9999999
increment by 1
start with 1
nocache;

drop sequence reply_no_seq;
create sequence reply_no_seq
minvalue 1
maxvalue 9999999
increment by 1
start with 1
nocache;

drop sequence qna_no_seq;
create sequence qna_no_seq
minvalue 1
maxvalue 9999999
increment by 1
start with 1
nocache;

drop sequence faq_no_seq;
create sequence faq_no_seq
minvalue 1
maxvalue 9999999
increment by 1
start with 1
nocache;

drop sequence product_no_seq;
create sequence product_no_seq
minvalue 1
maxvalue 9999999
increment by 1
start with 1
nocache;

drop sequence categori_no_seq;
create sequence categori_no_seq
minvalue 1
maxvalue 9999999
increment by 1
start with 1
nocache;

drop sequence orderlist_no_seq;
create sequence orderlist_no_seq
minvalue 1
maxvalue 9999999
increment by 1
start with 1
nocache;
